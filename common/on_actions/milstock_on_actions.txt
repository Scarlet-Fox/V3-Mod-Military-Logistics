# When a logistics center is built, let's create the variables to track the stockpile amounts.
# I have no idea if we're suppose to pre-create them, but this soothes my neurosis, and
# it's important for my neurosis to be abated.
on_building_built = {
	on_actions = {
		milstock_logicenter_constructed
	}
}

milstock_logicenter_constructed = {
	effect = {
    	if = {
        	limit = {
            	is_building_type = milstock_building_logistics_center
			}
			ROOT.state = {
				set_variable = {
					name = milstock_state_small_arms_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_grain_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_liquor_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_sugar_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_opium_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_tobacco_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_fabric_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_groceries_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_ammunition_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_artillery_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_radios_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_tanks_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_oil_stockpile_var
					value = 0
				}
				set_variable = {
					name = milstock_state_iron_stockpile_var
					value = 0
				}
			}
			debug_log = "Logistics center building constructed."
		}
	}
}

#on_monthly_pulse_state = {
#	on_actions = {
#		milstock_increase_stockpiles
#	}
#}

#milstock_increase_stockpiles = {
#	effect = {
#		every_scope_building = {
#			limit = {
#				is_building_type = milstock_building_logistics_center
#			}
#			set_variable = {
#
#			}
#		}
#	}
#}

## has_employee_slots_filled
#Checks whether the amount of employees of a certain poptype are above or below a given percentage of the total amount the building can currently hire. I.e. if a building is at 80% (given as 0.8) of its current hiring capacity for Shopkeepers, for example.  
#has_employee_slots_filled = { pop_type = X percent = Y }  
#Where X is a pop type and Y is a fixed point  
#**Supported Scopes**: building  



# If the state has a logistics center
# For each production method, add the purchased goods multiplied by the clerk employment ratio to the stockpile
# |--> Apply a 20% malus if the officer employment ratio is less than 50%

# Each month, we'll add a scaled representation of the month's stockpiled amount to the
# stockpile in any state with a building.
#on_monthly_pulse_state = {
#   effect = {
#       if = {
#           limit = {
#               has_building = milstock_building_stockpiles
#           }
#           every_scope_building = {
#               limit = {
#                   is_building_type = milstock_building_stockpiles
#               }
#               ROOT.state = {
#                   set_variable = {
#                       name = milstock_state_small_arms_stockpile_increase_var
#                       value = {
#                           
#                       }
#                   }
#               }
#           }
#
#           change_variable = {
#               name = milstock_state_small_arms_stockpile_var
#               add = {
#
#               }
#           }
#       }
#   }
#}